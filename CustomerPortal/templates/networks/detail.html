{% extends 'base.html' %}

{% load i18n %}
{% load static %}
{% load staticfiles %}

{% block layout %}
  <style>
  .portal-network-details > div {
    margin-bottom: 15px;
    padding: 0 10px;
  }
  .portal-network-details .SortableTable tr.pagination {
    display: table-row;
    margin: 0;
  }
  .portal-network-details .SortableTable div.pages > span {
    height: 2.5em;
  }
  .portal-network-details select.limiter {
    padding: 6px 16px;
    background-color: #fff;
  }
  .portal-network-details .label {
    color: #333;
  }
  </style>
<script data-key="{{ object.data_key }}" data-token="{{ object.data_token }}" data-network-id="{{ object.data_network_id }}" src="{% static 'js/pull-data.js' %}"></script>

<div>

  <!-- Nav tabs -->
  <ul class="nav nav-tabs network-detail-tabs" role="tablist">
    <li role="presentation" class="active"><a href="#portalApplicationPieChart" data-portalid="portal-ApplicationPieChart" aria-controls="portalApplicationPieChart" role="tab" data-toggle="tab">Overview</a></li>
    <li role="presentation"><a href="#portalApplicationTable" data-portalid="portal-ApplicationTable" aria-controls="portalApplicationTable" role="tab" data-toggle="tab">Applications</a></li>
    <li role="presentation"><a href="#portalNetworkHistogram" data-portalid="portal-NetworkHistogram" aria-controls="portalNetworkHistogram" role="tab" data-toggle="tab">Histogram</a></li>
    <li role="presentation"><a href="#portalNetworkMap" data-portalid="portal-NetworkMap" aria-controls="portalNetworkMap" role="tab" data-toggle="tab">Map</a></li>
    <li role="presentation"><a href="#portalNodeTable" data-portalid="portal-NodeTable" aria-controls="portalNodeTable" role="tab" data-toggle="tab">Access Points</a></li>
    <li role="presentation"><a href="#portalNodeTableCompact" data-portalid="portal-NodeTableCompact" aria-controls="portalNodeTableCompact" role="tab" data-toggle="tab">Access Points (Compact)</a></li>
    <li role="presentation"><a href="#portalClientTable" data-portalid="portal-ClientTable" aria-controls="portalClientTable" role="tab" data-toggle="tab">Clients</a></li>
    <li role="presentation"><a href="#portalSurveyTable" data-portalid="portal-SurveyTable" aria-controls="portalSurveyTable" role="tab" data-toggle="tab">Site Survey</a></li>
  </ul>

  <!-- Tab panes -->
  <div class="tab-content portal-network-details">
    <!-- Application data pie chart -->
    <div role="tabpanel" class="tab-pane active" id="portalApplicationPieChart">
      <div class="portal-ApplicationPieChart"></div>
    </div>

    <!-- Application data sortable table -->
    <div role="tabpanel" class="tab-pane" id="portalApplicationTable">
      <div class="portal-ApplicationTable"></div>
    </div>

    <!-- Network usage histogram -->
    <div role="tabpanel" class="tab-pane" id="portalNetworkHistogram">
      <div class="portal-NetworkHistogram"></div>
    </div>

    <!-- Network map -->
    <div role="tabpanel" class="tab-pane" id="portalNetworkMap">
      <div class="portal-NetworkMap"></div>
    </div>

    <!-- Access point sortable table -->
    <div role="tabpanel" class="tab-pane" id="portalNodeTable">
      <div class="portal-NodeTable"></div>
    </div>

    <!-- Access point sortable table with some columns removed for compactness -->
    <div role="tabpanel" class="tab-pane" id="portalNodeTableCompact">
      <div class="portal-NodeTableCompact"></div>
    </div>

    <!-- Client sortable table -->
    <div role="tabpanel" class="tab-pane" id="portalClientTable">
      <div class="portal-ClientTable"></div>
    </div>

    <!-- Site survey sortable table -->
    <div role="tabpanel" class="tab-pane" id="portalSurveyTable">
      <div class="portal-SurveyTable"></div>
    </div>
  </div>
</div>
  <script language="javascript">
  var detailLoads = {};
  $(".network-detail-tabs a").click(function () {
    var obj = this;
    setTimeout(function () {
      var objID = $(obj).attr("href").substring(1);
      var portalId = $(obj).data("portalid");
      console.log(objID, $('#' + objID).width());
      if (!detailLoads[portalId]) {
        detailLoads[portalId] = cloudtrax.reload(portalId);
      }
    },10);
  });
  </script>
{% endblock %}